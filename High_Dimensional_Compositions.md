---
author: Dominic LaRoche
date: YYYY-MM-DD
slug: INSERT\_SLUG\_HERE
status: draft
title: When is a composition not a composition?
categories:
  - r
---
When can I ignore the compositional property of my data?
========================================================

My work involves the analysis of data generated by next-generation sequencing (NGS) platforms. Data from NGS platforms generally falls under the umbrella of 'high dimensional compositions'. I have often**<sup>1</sup> been asked how severe the constant sum constraint is for high dimensional data with such a large constraint, when can we safely ignore the compositional nature of the data? This post is an attempt to answer that question.

Intuitively, if we increase the constraint to infinity we no longer have a constraint. Is there some constraint &lt;∞ for which a composition ceses to be a composition for all practical purposes?

Also, if you slice up a composition into nearly infinite parts, how much depedence would one expect between the parts. Intuitively, this dependence would decrease with increasing parts.

So let's put some math behind the intuition and try to answer this question.

Compositions of very high dimension
-----------------------------------

Let's start with the dimension question. How many components are necessary to safely ignore the interdependence between the components? the problem arises from what John Aitchison described as the "negative bias problem" (note: this is not bias in the traditional estimation sense). We start with the recognition that every D-part composition can be rescaled by a constant such that the components sum to 1 (*hint - this is forshadowing the discussion of the large sum constraint*).

*x*<sub>1</sub> + *x*<sub>2</sub> + … + *x*<sub>*D*</sub> = 1

From the definition of covariance (cov(*X*, *Y*)=E((*X* − *μ*<sub>*x*</sub>)(*Y* − *μ*<sub>*y*</sub>))) and the sum constraint we have,

cov(*x*<sub>1</sub>,  *x*<sub>1</sub> + … + *x*<sub>*D*</sub>)=0,

i.e. the covariance of any individual component with the sum of all the components is 0 (since the covariance of any random variable with a constant is 0). Moreover,

cov(*x*<sub>1</sub>,  *x*<sub>2</sub> + … + *x*<sub>*D*</sub>)=cov(*x*<sub>1</sub>,  1 − *x*<sub>1</sub>)= − var(*x*),

which also implies,

cov(*x*<sub>1</sub>,  *x*<sub>2</sub>)+cov(*x*<sub>1</sub>,  *x*<sub>3</sub>)+…+cov(*x*<sub>1</sub>,  *x*<sub>*D*</sub>)= − var(*x*)<sup>\* \* 2</sup>

Essenially, every row of the covariance *must* have negative values! This means that at least some covariances are constrained to be negative -- **which means we can't interpret the covariances in the traditional sense**. As you can see from the above equalities, the 'negative bias' of the covariance matrix does not depend on the dimension, *D*.

OK, we can't escape the problem of inter-dependence between components entirely, but maybe the problem becomes less severe as *D* increases?

------------------------------------------------------------------------

**<sup>1</sup> O.K. *often* is entirely relative here!

**<sup>2</sup> To prove this, simply plug in the values of *x*<sub>1</sub> and *x*<sub>2</sub> + *x*<sub>3</sub> into the formula for covariance:

cov(*x*<sub>1</sub>,  *x*<sub>2</sub> + *x*<sub>3</sub>)=E(*x*<sub>1</sub> + E*x*<sub>1</sub>)(*x*<sub>2</sub> + *x*<sub>3</sub> + E(*x*<sub>2</sub> + *x*<sub>3</sub>)) = E(*x*<sub>1</sub> + E*x*<sub>1</sub>)(*x*<sub>2</sub> + *x*<sub>3</sub> + E*x*<sub>2</sub> + E*x*<sub>3</sub>).

After multiplying the terms and distributing the expectation we get,

=E(*x*<sub>1</sub>*x*<sub>2</sub>)+E(*x*<sub>1</sub>*x*<sub>3</sub>)+*μ*<sub>1</sub>*μ*<sub>2</sub> + *μ*<sub>1</sub>*μ*<sub>3</sub>

Which is equivalent to,

=cov(*x*<sub>1</sub>,  *x*<sub>2</sub>)+cov(*x*<sub>1</sub>,  *x*<sub>3</sub>)
